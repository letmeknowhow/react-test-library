## 前端单元测试
### 什么是单元测试
单元测试特指被测试对象为程序中最小组成单位的测试。在过程化编程中，一个单元就是单个程序，函数，过程。在面向对象编程中，一个单元就是一个方法
单元测试与其它测试不同，单元测试是编码工作的一部分，应该有开发人员完成。

在组件化出现之前，UI的单元测试无从谈起，哪怕是对于 UI 页面层级的测试来说都是一件非常困难的事情。其实组件化并不全是为了复用，很多情况下也恰恰是为了分治，从而我们可以分组件对 UI 页面进行开发，然后分别对其进行单元测试

### 为什么要进行单元测试
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
1. 验证——把每一个单元看作是整个系统的一个零件，单元测试就是为了把这些零件与业务逻辑隔离，并确保这些零件可以正确的运行。
2. 设计——迫使我们把程序设计成易于调用和可测试的，迫使我们解除耦合
3. 文档——它是展示函数或类如何使用的最佳文档，而且单元测试是被动的时刻保持着可编译，可运行
4. 回归——避免代码回归，编写完成后，随时快速运行
5. 健壮发育——既方便重构，同时还可以确保不被后续的开发所破坏

### TDD —— Test-Driven Development
这些单元测试应该由开发者，在开发软件的同时编写对应的单元测试。它应该是内建的，而不是后补的：也即在编写实现的同时完成单元测试，而不是写完代码再一次性补足。
测试先行，这正是TDD的做法。使用 TDD 开发方法是得到可靠单元测试的唯一途径。

### 测试工具
- `JEST`
- `Enzyme`
- `React Testing Library`

### 利用JEST和React Testing Library测试React项目

#### 安装npm依赖
- jest
- @testing-library/jest-dom 自定义的jest匹配器(matchers)，用于测试DOM的状态（即为jest的except方法返回值增加更多专注于DOM的matchers）
- @testing-library/react

#### jest配置文件
```shell
./node_modules/.bin/jest --init
```
#### 结构
- Given —— 上下文，指定测试预设
- When —— 所要执行的操作
- Then —— 得到一系列可观察的后果，即需要检测的断言

#### 什么是好的单元测试
- 只关注输入输出，不关注内部实现
- 只测一条分支
- 表达力极强
- 不包含逻辑
- 运行速度快

#### 示例
- 快照
- 测试DOM元素
- 测试事件
- 测试异步操作
- 测试 React Redux
- 测试 React Router
- 测试HTTP请求

#### 报告
- `%stmts`是语句覆盖率（statement coverage）：是不是每个语句都执行了？
- `%Branch`分支覆盖率（branch coverage）：是不是每个if代码块都执行了？
- `%Funcs`函数覆盖率（function coverage）：是不是每个函数都调用了？
- `%Lines`行覆盖率（line coverage）：是不是每一行都执行了？